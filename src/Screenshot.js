var browser={versions:function(){var u=navigator.userAgent,app=navigator.appVersion;return{trident:u.indexOf('Trident')>-1,presto:u.indexOf('Presto')>-1,webKit:u.indexOf('AppleWebKit')>-1,gecko:u.indexOf('Gecko')>-1&&u.indexOf('KHTML')==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf('Android')>-1||u.indexOf('Linux')>-1,iPhone:u.indexOf('iPhone')>-1,iPad:u.indexOf('iPad')>-1,webApp:u.indexOf('Safari')==-1};}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()}
var ly$=function(id){if("string"==typeof id)
{if(id==null||""==id)return null;return document.getElementById(id);}
return id;};var Class={create:function(){return function(){this.initialize.apply(this,arguments);}}}
var Bind=function(object,fun){return function(){return fun.apply(object,arguments);}}
var BindWithArgs=function(object,fun){var args=Array.prototype.slice.call(arguments).slice(2);return function(){return fun.apply(object,args);}}
var Extend=function(destination,source){for(var property in source){destination[property]=source[property];}}
var BindAsEventListener=function(object,fun){var args=Array.prototype.slice.call(arguments).slice(2);return function(event){return fun.apply(object,[event||window.event].concat(args));}}
var CurrentStyle=function(element){return element.currentStyle||document.defaultView.getComputedStyle(element,null);}
function addEventHandler(oTarget,sEventType,fnHandler){if(oTarget.addEventListener){oTarget.addEventListener(sEventType,fnHandler,false);}else if(oTarget.attachEvent){oTarget.attachEvent("on"+sEventType,fnHandler);}else{oTarget["on"+sEventType]=fnHandler;}};function removeEventHandler(oTarget,sEventType,fnHandler){if(oTarget.removeEventListener){oTarget.removeEventListener(sEventType,fnHandler,false);}else if(oTarget.detachEvent){oTarget.detachEvent("on"+sEventType,fnHandler);}else{oTarget["on"+sEventType]=null;}};function delElemObj(obj){if(!!obj){$(obj).remove();}}
function scaleToRect(width,heigth,rectWidth,rectHeigth)
{var scale1=width/heigth;var scale2=rectWidth/rectHeigth;var retAry=null;if(scale1==scale2)retAry=[rectWidth,rectHeigth,width/rectWidth];else if(scale1>scale2)retAry=[rectWidth,heigth*rectWidth/width,width/rectWidth];else retAry=[width*rectHeigth/heigth,rectHeigth,heigth/rectHeigth];return retAry;}
function getObjectURL(file){var url=null;if(window.createObjectURL!=undefined){url=window.createObjectURL(file);}else if(window.URL!=undefined){url=window.URL.createObjectURL(file);}else if(window.webkitURL!=undefined){url=window.webkitURL.createObjectURL(file);}else if(window.createBlobURL!=undefined){url=window.createBlobURL(file);}else{return null;}
return url;}
function makeEvt(e){e.clientX=e.targetTouches[0].pageX;e.clientY=e.targetTouches[0].pageY;return[e];}
var debugDiv=ly$("debugDiv");var MoblieDragHandler=Class.create();MoblieDragHandler.prototype={initialize:function(){this.fmu=null;BindAsEventListener=function(object,fun){var args=Array.prototype.slice.call(arguments).slice(2);return function(event){var e=event||window.event;if(!!debugDiv)debugDiv.innerHTML+="</br>f5 "+e.type;return fun.apply(object,makeEvt(event||window.event).concat(args));};};var control=navigator.control||{};if(control.gesture){control.gesture(false);}},wmu:function(e){if(!!debugDiv)debugDiv.innerHTML+="yyy";if(!!this.curTarget)
{this.curBlur.apply(this.curTarget,arguments);this.curBlur=null;this.curTarget=null;}
this.fmu(e);},setBlurAndCap:function(object,oEvent,fnHandler){oEvent.preventDefault();if(!!fnHandler)
{this.curBlur=fnHandler;this.curTarget=object;}},setMouseDown:function(object,fun){addEventHandler(object,"touchstart",fun);},setMouseUp:function(object,fun){this.fmu=fun;this.bindfmu=Bind(this,this.wmu);addEventHandler(object,"touchend",this.bindfmu);},setMouseMove:function(object,fun){addEventHandler(object,"touchmove",fun);},unsetBlurAndCap:function(object,fnHandler){},unsetMouseUp:function(object,fun){removeEventHandler(object,"touchend",this.bindfmu);},unsetMouseMove:function(object,fun){removeEventHandler(object,"touchmove",fun);},};var IEDragHandler=Class.create();IEDragHandler.prototype={initialize:function(){},setBlurAndCap:function(object,oEvent,fnHandler){if(!!debugDiv)debugDiv.innerHTML+="</br>ie ";addEventHandler(object,"losecapture",fnHandler);object.setCapture();},setMouseDown:function(object,fun){addEventHandler(object,"mousedown",fun);},setMouseUp:function(object,fun){addEventHandler(object,"mouseup",fun);},setMouseMove:function(object,fun){addEventHandler(object,"mousemove",fun);},unsetBlurAndCap:function(object,fnHandler){removeEventHandler(object,"losecapture",fnHandler);object.releaseCapture();},unsetMouseUp:function(object,fun){removeEventHandler(object,"mouseup",fun);},unsetMouseMove:function(object,fun){removeEventHandler(object,"mousemove",fun);}}
var FFDragHandler=Class.create();FFDragHandler.prototype={initialize:function(){this.fmu=null;},wmu:function(e){if(!!debugDiv)debugDiv.innerHTML+="yyy";this.fmu(e);},setBlurAndCap:function(object,oEvent,fnHandler){if(!!debugDiv)debugDiv.innerHTML+="</br>ff ";addEventHandler(window,"blur",fnHandler);oEvent.preventDefault();},setMouseDown:function(object,fun){addEventHandler(object,"mousedown",fun);},setMouseUp:function(object,fun){this.fmu=fun;this.bindfmu=Bind(this,this.wmu);addEventHandler(object,"mouseup",this.bindfmu);},setMouseMove:function(object,fun){addEventHandler(object,"mousemove",fun);},unsetBlurAndCap:function(object,fnHandler){removeEventHandler(window,"blur",fnHandler);},unsetMouseUp:function(object,fun){removeEventHandler(object,"mouseup",this.bindfmu);},unsetMouseMove:function(object,fun){removeEventHandler(object,"mousemove",fun);}}
var isIE=(document.all)?true:false;var isIE6=isIE&&([/MSIE (\d)\.0/i.exec(navigator.userAgent)][0][1]==6);var browser={versions:function(){var u=navigator.userAgent,app=navigator.appVersion;return{trident:u.indexOf('Trident')>-1,presto:u.indexOf('Presto')>-1,webKit:u.indexOf('AppleWebKit')>-1,gecko:u.indexOf('Gecko')>-1&&u.indexOf('KHTML')==-1,mobile:!!u.match(/AppleWebKit.*Mobile.*/)||!!u.match(/AppleWebKit/),ios:!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:u.indexOf('Android')>-1||u.indexOf('Linux')>-1,iPhone:u.indexOf('iPhone')>-1||u.indexOf('Mac')>-1,iPad:u.indexOf('iPad')>-1,webApp:u.indexOf('Safari')==-1,google:u.indexOf('Chrome')>-1};}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()}
function GetDragHandler()
{if(browser.versions.mobile)return new MoblieDragHandler();if(isIE)return new IEDragHandler();return new FFDragHandler();}
var ImgCropper=Class.create();ImgCropper.prototype={SetOptions:function(options){this.options={Opacity:100,Color:"",Width:0,Height:0,Resize:false,Right:"",Left:"",Up:"",Down:"",RightDown:"",LeftDown:"",RightUp:"",LeftUp:"",Min:true,minWidth:160,minHeight:80,Scale:true,Ratio:160/80,Preview:null,viewWidth:0,viewHeight:0,containerWidth:0,containerHeight:0,hDrag:null,onload:null};Extend(this.options,options||{});},clear:function(){delElemObj(this._layBase);this._layBase=null;delElemObj(this._layCropper);this._layCropper=null;delElemObj(this._tempImg);this._tempImg=null;delElemObj(this._view);this._view=null;this.loadedImg=0;this.oughtToLoadImg=0;},imgloaded:function(index){++this.loadedImg;if(index==0){}else if(index==1){this.SetPos();}else if(index==2){this.SetSize();}else if(index==3){this.SetPreview();}else{--this.loadedImg;}
if(this.loadedImg>=this.oughtToLoadImg)
{if(isIE){this._layBase.style.filter="alpha(opacity:"+this.Opacity+")";}else{this._layBase.style.opacity=this.Opacity/100;}
this._view&&(this._view.src=this.Url);if(this.Resize){with(this._resize){Scale=this.Scale;Ratio=this.Ratio;Min=this.Min;minWidth=this.minWidth;minHeight=this.minHeight;}}
this.options.onload();}},initialize:function(container,handle,url,options){this._Container=ly$(container);this._layHandle=ly$(handle);this.Url=url;if(!!this.loadedImg&&this.loadedImg!=0)this.clear();else{this.loadedImg=0;this.oughtToLoadImg=0;}
this._layBase=this._Container.appendChild(document.createElement("img"));++this.oughtToLoadImg;this._layBase.onload=BindWithArgs(this,this.imgloaded,0);this._layCropper=this._Container.appendChild(document.createElement("img"));++this.oughtToLoadImg;this._layCropper.onload=BindWithArgs(this,this.imgloaded,1);this._tempImg=document.createElement("img");++this.oughtToLoadImg;this._tempImg.onload=BindWithArgs(this,this.imgloaded,2);this.SetOptions(options);if(!this.options.hDrag)this.hDrag=GetDragHandler();else this.hDrag=this.options.hDrag;if(!!debugDiv)debugDiv.innerHTML+="start!";this.Opacity=Math.round(this.options.Opacity);this.Color=this.options.Color;this.Scale=!!this.options.Scale;this.Ratio=Math.max(this.options.Ratio,0);var showRect=scaleToRect(this.options.Width,this.options.Height,this.options.containerWidth,this.options.containerHeight);this.Width=Math.round(showRect[0]);this.Height=Math.round(showRect[1]);this.scalerate=showRect[2];var oPreview=null;if(this.options.Preview!=null)oPreview=ly$(this.options.Preview);if(oPreview){oPreview.style.position="relative";oPreview.style.overflow="hidden";this.viewWidth=Math.round(this.options.viewWidth);this.viewHeight=Math.round(this.options.viewHeight);this._view=oPreview.appendChild(document.createElement("img"));this._view.style.position="absolute";this._view.onload=BindWithArgs(this,this.imgloaded,3);++this.oughtToLoadImg;}
this._drag=new Drag(this._layHandle,{Limit:true,onMove:Bind(this,this.SetPos),Transparent:true,hDrag:this.hDrag,swidht:this.options.minWidth,sheight:this.options.minHeight});this.Resize=!!this.options.Resize;if(this.Resize){var op=this.options,_resize=new Resize(this._layHandle,{Max:true,mxContainer:container,onResize:Bind(this,this.SetPos),hDrag:this.hDrag,mxLeft:0,mxRight:this.Width,mxTop:0,mxBottom:this.Height,});op.RightDown&&(_resize.Set(op.RightDown,"right-down"));op.LeftDown&&(_resize.Set(op.LeftDown,"left-down"));op.RightUp&&(_resize.Set(op.RightUp,"right-up"));op.LeftUp&&(_resize.Set(op.LeftUp,"left-up"));this.Min=!!this.options.Min;this.minWidth=Math.round(this.options.minWidth);this.minHeight=Math.round(this.options.minHeight);this._resize=_resize;}
with(this._Container.style)
{position="relative";overflow="hidden";zIndex=100;width=this.Width;height=this.Height;}
this._layHandle.style.zIndex=200;this._layBase.style.position=this._layCropper.style.position="absolute";this._layBase.style.top=this._layBase.style.left=this._layCropper.style.top=this._layCropper.style.left=0;this.Init();},Init:function(){this.Color&&(this._Container.style.backgroundColor=this.Color);this._tempImg.src=this._layBase.src=this._layCropper.src=this.Url;},SetPos:function(){if(isIE6){with(this._layHandle.style){zoom=.9;zoom=1;};};var p=this.GetPos();this._layCropper.style.clip="rect("+p.Top+"px "+(p.Left+p.Width)+"px "+(p.Top+p.Height)+"px "+p.Left+"px)";if(this._view)this.SetPreview();},SetPreview:function(){if(this._view){var p=this.GetPos(),s=this.GetSize(p.Width,p.Height,this.viewWidth,this.viewHeight),scale=s.Height/p.Height;var pHeight=this._layBase.height*scale,pWidth=this._layBase.width*scale,pTop=p.Top*scale,pLeft=p.Left*scale;with(this._view.style){width=pWidth+"px";height=pHeight+"px";top=-pTop+"px ";left=-pLeft+"px";clip="rect("+pTop+"px "+(pLeft+s.Width)+"px "+(pTop+s.Height)+"px "+pLeft+"px)";}}},SetSize:function(){var s=this.GetSize(this._tempImg.width,this._tempImg.height,this.Width,this.Height);this._layBase.style.width=this._layCropper.style.width=s.Width+"px";this._layBase.style.height=this._layCropper.style.height=s.Height+"px";this._drag.mxRight=s.Width;this._drag.mxBottom=s.Height;if(this.Resize){this._resize.mxRight=s.Width;this._resize.mxBottom=s.Height;}},GetPos:function(){with(this._layHandle){return{Top:offsetTop,Left:offsetLeft,Width:offsetWidth,Height:offsetHeight}}},GetPicPos:function(){with(this._layHandle){return{Top:offsetTop*this.scalerate,Left:offsetLeft*this.scalerate,Width:offsetWidth*this.scalerate,Height:offsetHeight*this.scalerate}}},GetSize:function(nowWidth,nowHeight,fixWidth,fixHeight){var iWidth=nowWidth,iHeight=nowHeight,scale=iWidth/iHeight;if(fixHeight){iWidth=(iHeight=fixHeight)*scale;}
if(fixWidth&&(!fixHeight||iWidth>fixWidth)){iHeight=(iWidth=fixWidth)/scale;}
return{Width:iWidth,Height:iHeight}}}
var Drag=Class.create();Drag.prototype={SetOptions:function(options){this.options={Handle:"",Limit:false,mxLeft:0,mxRight:9999,mxTop:0,mxBottom:9999,swidht:0,sheight:0,mxContainer:"",LockX:false,LockY:false,Lock:false,Transparent:false,onStart:function(){},onMove:function(){},onStop:function(){},hDrag:null};Extend(this.options,options||{});},initialize:function(drag,options){this.Drag=ly$(drag);this._x=this._y=0;this._marginLeft=this._marginTop=0;this.SetOptions(options);if(!this.options.hDrag)this.hDrag=GetDragHandler();else this.hDrag=this.options.hDrag;this._fM=BindAsEventListener(this,this.Move);this._fS=Bind(this,this.Stop);this.Limit=!!this.options.Limit;this.mxLeft=parseInt(this.options.mxLeft);this.mxRight=parseInt(this.options.mxRight);this.mxTop=parseInt(this.options.mxTop);this.mxBottom=parseInt(this.options.mxBottom);this.LockX=!!this.options.LockX;this.LockY=!!this.options.LockY;this.Lock=!!this.options.Lock;this.onStart=this.options.onStart;this.onMove=this.options.onMove;this.onStop=this.options.onStop;this._Handle=ly$(this.options.Handle)||this.Drag;this._mxContainer=ly$(this.options.mxContainer)||null;var d=this.Drag.style;d.position="absolute";d.left="0px";d.top="0px";d.width=this.options.swidht+"px";d.height=this.options.sheight+"px";if(isIE&&!!this.options.Transparent){with(this._Handle.appendChild(document.createElement("div")).style){width=height="100%";backgroundColor="#fff";filter="alpha(opacity:0)";fontSize=0;}}
this.Repair();this.hDrag.setMouseDown(this._Handle,BindAsEventListener(this,this.Start));},Start:function(oEvent){if(!!debugDiv)debugDiv.innerHTML+="</br>drag start.";if(this.Lock){return;}
this.Repair();this._x=oEvent.clientX-this.Drag.offsetLeft;this._y=oEvent.clientY-this.Drag.offsetTop;this._marginLeft=parseInt(CurrentStyle(this.Drag).marginLeft)||0;this._marginTop=parseInt(CurrentStyle(this.Drag).marginTop)||0;this.hDrag.setMouseMove(document,this._fM);this.hDrag.setMouseUp(document,this._fS);this.hDrag.setBlurAndCap(this._Handle,oEvent,this._fS);this.onStart();},Repair:function(){if(this.Limit){this.mxRight=Math.max(this.mxRight,this.mxLeft+this.Drag.offsetWidth);this.mxBottom=Math.max(this.mxBottom,this.mxTop+this.Drag.offsetHeight);!this._mxContainer||CurrentStyle(this._mxContainer).position=="relative"||CurrentStyle(this._mxContainer).position=="absolute"||(this._mxContainer.style.position="relative");}},Move:function(oEvent){if(this.Lock){this.Stop();return;};window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();var iLeft=oEvent.clientX-this._x,iTop=oEvent.clientY-this._y;if(this.Limit){var mxLeft=this.mxLeft,mxRight=this.mxRight,mxTop=this.mxTop,mxBottom=this.mxBottom;if(!!this._mxContainer){mxLeft=Math.max(mxLeft,0);mxTop=Math.max(mxTop,0);mxRight=Math.min(mxRight,this._mxContainer.clientWidth);mxBottom=Math.min(mxBottom,this._mxContainer.clientHeight);};iLeft=Math.max(Math.min(iLeft,mxRight-this.Drag.offsetWidth),mxLeft);iTop=Math.max(Math.min(iTop,mxBottom-this.Drag.offsetHeight),mxTop);}
if(!this.LockX){this.Drag.style.left=iLeft-this._marginLeft+"px";}
if(!this.LockY){this.Drag.style.top=iTop-this._marginTop+"px";}
this.onMove();},Stop:function(){if(!!debugDiv)debugDiv.innerHTML+="</br>drag stop.";this.hDrag.unsetMouseMove(document,this._fM);this.hDrag.unsetMouseUp(document,this._fS);this.hDrag.unsetBlurAndCap(this._Handle,this._fS);if(!!debugDiv)debugDiv.innerHTML+="drager release.";this.onStop();}};var Resize=Class.create();Resize.prototype={SetOptions:function(options){this.options={Max:false,mxContainer:"",mxLeft:0,mxRight:9999,mxTop:0,mxBottom:9999,Min:true,minWidth:0,minHeight:0,Scale:false,Ratio:0,onResize:function(){},hDrag:null};Extend(this.options,options||{});},initialize:function(obj,options){this._obj=ly$(obj);this._minheight=this._styleWidth=this._styleHeight=this._styleLeft=this._styleTop=0;this._sideRight=this._sideDown=this._sideLeft=this._sideUp=0;this._fixLeft=this._fixTop=0;this._scaleLeft=this._scaleTop=0;this._mxSet=function(){};this._mxRightWidth=this._mxDownHeight=this._mxUpHeight=this._mxLeftWidth=0;this._mxScaleWidth=this._mxScaleHeight=0;this._fun=function(){};var _style=CurrentStyle(this._obj);this._borderX=(parseInt(_style.borderLeftWidth)||0)+(parseInt(_style.borderRightWidth)||0);this._borderY=(parseInt(_style.borderTopWidth)||0)+(parseInt(_style.borderBottomWidth)||0);this.SetOptions(options);if(!this.options.hDrag)this.hDrag=GetDragHandler();else this.hDrag=this.options.hDrag;this._fR=BindAsEventListener(this,this.Resize);this._fS=Bind(this,this.Stop);this.Max=!!this.options.Max;this._mxContainer=ly$(this.options.mxContainer)||null;this.mxLeft=Math.round(this.options.mxLeft);this.mxRight=Math.round(this.options.mxRight);this.mxTop=Math.round(this.options.mxTop);this.mxBottom=Math.round(this.options.mxBottom);this.Min=!!this.options.Min;this.minWidth=Math.round(this.options.minWidth);this.minHeight=Math.round(this.options.minHeight);this.Scale=!!this.options.Scale;this.Ratio=Math.max(this.options.Ratio,0);this.onResize=this.options.onResize;this._obj.style.position="absolute";!this._mxContainer||CurrentStyle(this._mxContainer).position=="relative"||(this._mxContainer.style.position="relative");this._minheight=this._obj.clientHeight+2;},Set:function(resize,side){var resize=ly$(resize),fun;if(!resize)return;switch(side.toLowerCase()){case"up":fun=this.Up;break;case"down":fun=this.Down;break;case"left":fun=this.Left;break;case"right":fun=this.Right;break;case"left-up":fun=this.LeftUp;break;case"right-up":fun=this.RightUp;break;case"left-down":fun=this.LeftDown;break;case"right-down":default:fun=this.RightDown;};this.hDrag.setMouseDown(resize,BindAsEventListener(this,this.Start,fun));},Start:function(e,fun,touch){e.stopPropagation?e.stopPropagation():(e.cancelBubble=true);if(!!debugDiv)debugDiv.innerHTML+="</br>sizer start."
this._fun=fun;this._styleWidth=this._obj.clientWidth;this._styleHeight=this._obj.clientHeight;this._styleLeft=this._obj.offsetLeft;this._styleTop=this._obj.offsetTop;this._sideLeft=e.clientX-this._styleWidth;this._sideRight=e.clientX+this._styleWidth;this._sideUp=e.clientY-this._styleHeight;this._sideDown=e.clientY+this._styleHeight;this._fixLeft=this._styleLeft+this._styleWidth;this._fixTop=this._styleTop+this._styleHeight;if(this.Scale){this.Ratio=Math.max(this.Ratio,0)||this._styleWidth/this._styleHeight;this._scaleLeft=this._styleLeft+this._styleWidth/2;this._scaleTop=this._styleTop+this._styleHeight/2;};if(this.Max){var mxLeft=this.mxLeft,mxRight=this.mxRight,mxTop=this.mxTop,mxBottom=this.mxBottom;if(!!this._mxContainer){mxLeft=Math.max(mxLeft,0);mxTop=Math.max(mxTop,0);mxRight=Math.min(mxRight,this._mxContainer.clientWidth);mxBottom=Math.min(mxBottom,this._mxContainer.clientHeight);};mxRight=Math.max(mxRight,mxLeft+(this.Min?this.minWidth:0)+this._borderX);mxBottom=Math.max(mxBottom,mxTop+(this.Min?this.minHeight:0)+this._borderY);this._mxSet=function(){this._mxRightWidth=mxRight-this._styleLeft-this._borderX;this._mxDownHeight=mxBottom-this._styleTop-this._borderY;this._mxUpHeight=Math.max(this._fixTop-mxTop,this.Min?this.minHeight:0);this._mxLeftWidth=Math.max(this._fixLeft-mxLeft,this.Min?this.minWidth:0);};this._mxSet();if(this.Scale){this._mxScaleWidth=Math.min(this._scaleLeft-mxLeft,mxRight-this._scaleLeft-this._borderX)*2;this._mxScaleHeight=Math.min(this._scaleTop-mxTop,mxBottom-this._scaleTop-this._borderY)*2;};};this.hDrag.setMouseMove(document,this._fR);this.hDrag.setMouseUp(document,this._fS);this.hDrag.setBlurAndCap(this._obj,e,this._fS);},Resize:function(e){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();this._fun(e);with(this._obj.style){width=this._styleWidth+"px";height=this._styleHeight+"px";if(this._styleWidth<=this._minheight){width=this._minwidth+"px";height=this._minheight+"px";}}
this.onResize();},Up:function(e){this.RepairY(this._sideDown-e.clientY,this._mxUpHeight);this.RepairTop();this.TurnDown(this.Down);},Down:function(e){this.RepairY(e.clientY-this._sideUp,this._mxDownHeight);this.TurnUp(this.Up);},Right:function(e){this.RepairX(e.clientX-this._sideLeft,this._mxRightWidth);this.TurnLeft(this.Left);},Left:function(e){this.RepairX(this._sideRight-e.clientX,this._mxLeftWidth);this.RepairLeft();this.TurnRight(this.Right);},RightDown:function(e){this.RepairAngle(e.clientX-this._sideLeft,this._mxRightWidth,e.clientY-this._sideUp,this._mxDownHeight);this.TurnLeft(this.LeftDown)||this.Scale||this.TurnUp(this.RightUp);},RightUp:function(e){this.RepairAngle(e.clientX-this._sideLeft,this._mxRightWidth,this._sideDown-e.clientY,this._mxUpHeight);this.RepairTop();this.TurnLeft(this.LeftUp)||this.Scale||this.TurnDown(this.RightDown);},LeftDown:function(e){this.RepairAngle(this._sideRight-e.clientX,this._mxLeftWidth,e.clientY-this._sideUp,this._mxDownHeight);this.RepairLeft();this.TurnRight(this.RightDown)||this.Scale||this.TurnUp(this.LeftUp);},LeftUp:function(e){this.RepairAngle(this._sideRight-e.clientX,this._mxLeftWidth,this._sideDown-e.clientY,this._mxUpHeight);this.RepairTop();this.RepairLeft();this.TurnRight(this.RightUp)||this.Scale||this.TurnDown(this.LeftDown);},RepairX:function(iWidth,mxWidth){iWidth=this.RepairWidth(iWidth,mxWidth);if(this.Scale){var iHeight=this.RepairScaleHeight(iWidth);if(this.Max&&iHeight>this._mxScaleHeight){iHeight=this._mxScaleHeight;iWidth=this.RepairScaleWidth(iHeight);}else if(this.Min&&iHeight<this.minHeight){var tWidth=this.RepairScaleWidth(this.minHeight);if(tWidth<mxWidth){iHeight=this.minHeight;iWidth=tWidth;}}
this._styleHeight=iHeight;this._styleTop=this._scaleTop-iHeight/2;}
this._styleWidth=iWidth;},RepairY:function(iHeight,mxHeight){iHeight=this.RepairHeight(iHeight,mxHeight);if(this.Scale){var iWidth=this.RepairScaleWidth(iHeight);if(this.Max&&iWidth>this._mxScaleWidth){iWidth=this._mxScaleWidth;iHeight=this.RepairScaleHeight(iWidth);}else if(this.Min&&iWidth<this.minWidth){var tHeight=this.RepairScaleHeight(this.minWidth);if(tHeight<mxHeight){iWidth=this.minWidth;iHeight=tHeight;}}
this._styleWidth=iWidth;this._styleLeft=this._scaleLeft-iWidth/2;}
this._styleHeight=iHeight;},RepairAngle:function(iWidth,mxWidth,iHeight,mxHeight){iWidth=this.RepairWidth(iWidth,mxWidth);if(this.Scale){iHeight=this.RepairScaleHeight(iWidth);if(this.Max&&iHeight>mxHeight){iHeight=mxHeight;iWidth=this.RepairScaleWidth(iHeight);}else if(this.Min&&iHeight<this.minHeight){var tWidth=this.RepairScaleWidth(this.minHeight);if(tWidth<mxWidth){iHeight=this.minHeight;iWidth=tWidth;}}}else{iHeight=this.RepairHeight(iHeight,mxHeight);}
this._styleWidth=iWidth;this._styleHeight=iHeight;},RepairTop:function(){this._styleTop=this._fixTop-this._styleHeight;},RepairLeft:function(){this._styleLeft=this._fixLeft-this._styleWidth;},RepairHeight:function(iHeight,mxHeight){iHeight=Math.min(this.Max?mxHeight:iHeight,iHeight);iHeight=Math.max(this.Min?this.minHeight:iHeight,iHeight,0);return iHeight;},RepairWidth:function(iWidth,mxWidth){iWidth=Math.min(this.Max?mxWidth:iWidth,iWidth);iWidth=Math.max(this.Min?this.minWidth:iWidth,iWidth,0);return iWidth;},RepairScaleHeight:function(iWidth){return Math.max(Math.round((iWidth+this._borderX)/this.Ratio-this._borderY),0);},RepairScaleWidth:function(iHeight){return Math.max(Math.round((iHeight+this._borderY)*this.Ratio-this._borderX),0);},TurnRight:function(fun){if(!(this.Min||this._styleWidth)){this._fun=fun;this._sideLeft=this._sideRight;this.Max&&this._mxSet();return true;}},TurnLeft:function(fun){if(!(this.Min||this._styleWidth)){this._fun=fun;this._sideRight=this._sideLeft;this._fixLeft=this._styleLeft;this.Max&&this._mxSet();return true;}},TurnUp:function(fun){if(!(this.Min||this._styleHeight)){this._fun=fun;this._sideDown=this._sideUp;this._fixTop=this._styleTop;this.Max&&this._mxSet();return true;}},TurnDown:function(fun){if(!(this.Min||this._styleHeight)){this._fun=fun;this._sideUp=this._sideDown;this.Max&&this._mxSet();return true;}},Stop:function(){this.hDrag.unsetMouseMove(document,this._fR);this.hDrag.unsetMouseUp(document,this._fS);this.hDrag.unsetBlurAndCap(this._obj,this._fS);if(!!debugDiv)debugDiv.innerHTML+="sizer release.";}};function LoadJS(id,fileUrl)
{var scriptTag=document.getElementById(id);var oHead=document.getElementsByTagName('HEAD').item(0);var oScript=document.createElement("script");if(scriptTag)oHead.removeChild(scriptTag);oScript.id=id;oScript.type="text/javascript";oScript.src=fileUrl;oHead.appendChild(oScript);}